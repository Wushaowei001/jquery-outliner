<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><html>
	<title>jquery.bgOutliner.js – Tests</title>
	<link rel="stylesheet" media="all" href="../css/bgNestedSortable.css" />
  <link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css" media="screen" />
</head>
<body>
  <!--Example tree structure-->
	<table id="outliner">
		<thead>
			<tr id="header-row">
				<th class="nested-data-cell">Titel</th>
				<th>Författare</th>
				<th>Publicerad</th>
			</tr>
		</thead>
		<tbody id="outliner-tbody">
			<tr id="row1" class="has-children level0">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row1[id]" id="row1-id" value="123" />
						<span class="nested-data">Test 1</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row2" class="child-of-row1 level1">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row2[id]" id="row2-id" value="123" />
						<span class="nested-data">Test 2</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row3" class="child-of-row1 has-children level1">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row3[id]" id="row3-id" value="123" />
						<span class="nested-data">Test 3</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row4" class="child-of-row3 level2">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row4[id]" id="row4-id" value="123" />
						<span class="nested-data">Test 4</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row5" class="has-children child-of-row3 level2">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row5[id]" id="row5-id" value="123" />
						<span class="nested-data">Test 5</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row6" class="has-children child-of-row5 level3">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row6[id]" id="row6-id" value="123" />
						<span class="nested-data">Test 6</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
			<tr id="row7" class="child-of-row6 level4">
				<td class="nested-data-cell">
					<span class="add-edit-icons">
						<a href="#" title="Add node" class="add-node"><img src="../images/add.gif" alt="Add child" /></a>
						<a href="#" title="Remove node" class="remove-node"><img src="../images/trash.gif" alt="Remove node" /></a>
					</span>
					<span class="expand-collapse-icon"></span>
					<form action="#" method="post">
						<input type="hidden" name="row7[id]" id="row7-id" value="123" />
						<span class="nested-data">Test 7</span>
					</form>
				</td>
				<td>Henrik Almér</td>
				<td>2010-05-07</td>
			</tr>
		</tbody>
	</table>
	<!--End example tree structure-->
	
	<!--qUnit Tests-->
	<h1 id="qunit-header">jQuery.bgOutliner Test Suite</h1>
  <h2 id="qunit-banner"></h2>
  <div id="qunit-testrunner-toolbar"></div>
  <h2 id="qunit-userAgent"></h2>
  <ol id="qunit-tests"></ol>
  <div id="qunit-fixture">test markup, will be hidden</div>
  <!--End qUnit Tests-->

	<!--JavaScript Below--> 
	<script src="http://www.google.com/jsapi" type="text/javascript"></script>
	<script type="text/javascript">
	// <![CDATA[
		google.load('jquery', '1.4.2');
		google.load('jqueryui', '1.8.1');
	// ]]>
	</script>
	<script type="text/javascript" src="../src/jquery.bgOutliner.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
  
  <!--Define and run tests-->
  <script type="text/javascript">
    // <![CDATA[
    jQuery(function() {

      /**
       * General tests
       */

      module('General');
      
      test('Error should be thrown if non existing method is called', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('nonExistingMethod');
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });

      /**
       * Init method tests
       */

      module('Init method');

      test('Assert that a data object is set for the given element after the plugin has been instanced, but not before', function() {
        expect(2);
        equal($('#outliner tbody').data('bgOutliner'),
              null,
              'Data object was null before initiating the instance');
        notEqual($('#outliner tbody').bgOutliner().data('bgOutliner'),
                 null,
                 'Data object was not null after initiating the instance');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('An error should be thrown if the init method is called on an element that is already an instance of the plugin', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        raises(function() {
          $('#outliner').bgOutliner();
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });

      test('An error should be thrown if the plugin is instanced on an element that does not have one or more tr elements as children', function() {
        raises(function() {
          $('#outliner').bgOutliner();
        }, 'Error was thrown');
      });
      
      test('A reference to the supplied DOM element should be returned when successfully instancing the plugin on an element', function() {
        equal($('#outliner tbody').attr('id'),
              $('#outliner tbody').bgOutliner().attr('id'),
              'The id attribute matched');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Update Settings method tests
       */

      module('Update Settings method');
      
      test('You should not be able to update settings for an uninstanced object', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('updateSettings', {});
        }, 'Error was thrown');
      });

      test('Settings should be updated when the updateSettings method is called', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        $('#outliner tbody').bgOutliner('updateSettings',
                                        {'edit': false});
        equal($('#outliner tbody')
                .data('bgOutliner')
                .settings.edit,
              false,
              'Settings were updated');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });

      /**
       * Destroy method tests
       */

      module('Destroy method');
      
      test('You should not be able to destroy an uninstanced object', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('destroy');
        }, 'Error was thrown');
      });
      
      test('Data object should be null after the instance has been destroyed, but not before', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        expect(2);
        notEqual($('#outliner tbody').data('bgOutliner'),
                 null,
                 'Data object was not null before destroying the instance');

        equal($('#outliner tbody').bgOutliner('destroy').data('bgOutliner'),
              null,
              'Data object was null after destroying the instance');
      });
      
      /**
       * Toggle Node method tests
       */

      module('Toggle Node method');
      
      test('Invoking toggleNode on row 1 should make row 2 and 3 visible', function() {
        expect(2);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        // Toggle children of row 1 (should make them visible)
        $('#outliner tbody').bgOutliner('toggleNode', $('#row1'));
        ok($('#outliner tbody #row2:visible').length > 0, 'Row 2 was visible after toggling children of row 1');
        ok($('#outliner tbody #row3:visible').length > 0, 'Row 3 was visible after toggling children of row 1');
      });
      
      test('Invoking toggleNode on row 3, after having invoked in on row 1, should make row 4 and 5 visible', function() {
        expect(2);
      
        // Toggle children of row 3 (should make them visible)
        $('#outliner tbody').bgOutliner('toggleNode', $('#row3'));
        ok($('#outliner tbody #row4:visible').length > 0, 'Row 4 was visible after toggling children of row 3');
        ok($('#outliner tbody #row5:visible').length > 0, 'Row 5 was visible after toggling children of row 3');
      });
      
      test('Invoking toggleNode on row 1 once more should make rows 2, 3, 4 and 5 hidden', function() {
        expect(4);
      
        // Toggle children of row 1 (should make them hidden)
        $('#outliner tbody').bgOutliner('toggleNode', $('#row1'));
        ok($('#outliner tbody #row2:visible').length <= 0, 'Row 2 was hidden after toggling children of row 1');
        ok($('#outliner tbody #row3:visible').length <= 0, 'Row 3 was hidden after toggling children of row 1');
        ok($('#outliner tbody #row4:visible').length <= 0, 'Row 4 was hidden after toggling children of row 1');
        ok($('#outliner tbody #row5:visible').length <= 0, 'Row 5 was hidden after toggling children of row 1');
      });
      
      test('Invoking toggleNode on row 1 yet again should make rows 2, 3, 4 and 5 visible', function() {
        expect(4);
      
        // Toggle children of row 1 (should make them visible)
        $('#outliner tbody').bgOutliner('toggleNode', $('#row1'));
        ok($('#outliner tbody #row2:visible').length > 0, 'Row 2 was visible after toggling children of row 1');
        ok($('#outliner tbody #row3:visible').length > 0, 'Row 3 was visible after toggling children of row 1');
        ok($('#outliner tbody #row4:visible').length > 0, 'Row 4 was visible after toggling children of row 1');
        ok($('#outliner tbody #row5:visible').length > 0, 'Row 5 was visible after toggling children of row 1');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Get Level method tests
       */
      
      module('Get Level method');
      
      test('Invoking getLevel on an element that is not a plugin instance should throw an error', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('getLevel');
        }, 'Error was thrown');
      });
      
      test('Invoking getLevel with an argument that is not a direct child of an instance should throw an error', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('getLevel', $('#header-row'));
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Invoking getLevel with an argument that is a direct child of an instance should return an integer referencing that rows level', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row1')), 0, 'Row 1 is level 0');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row2')), 1, 'Row 2 is level 1');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row3')), 1, 'Row 3 is level 1');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row4')), 2, 'Row 4 is level 2');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row5')), 2, 'Row 5 is level 2');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row6')), 3, 'Row 6 is level 3');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row7')), 4, 'Row 7 is level 4');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Has Children method tests
       */
      
      module('Has Children method');
      
      test('Invoking hasChildren on an element that is not a plugin instance should throw an error', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('hasChildren');
        }, 'Error was thrown');
      });
      
      test('Invoking hasChildren with an argument that is not a direct child of an instance should throw an error', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('hasChildren', $('#header-row'));
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('hasChildren should return true if the element is a parent, and false if not', function() {
        expect(2);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        ok($('#outliner tbody').bgOutliner('hasChildren', $('#row2')) == false, 'Returned false for row 2');
        ok($('#outliner tbody').bgOutliner('hasChildren', $('#row1')), 'Returned true for row 1');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Get Parent method tests
       */
      
      module('Get Parent method');
      
      test('Invoking getParent on an element that is not a plugin instance should throw an error', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('getParent');
        }, 'Error was thrown');
      });
      
      test('Invoking getParent with an argument that is not a direct child of an instance should throw an error', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('getParent', $('#header-row'));
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Get parent should return null for a top level node, and a correct integer for child nodes', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        equal($('#outliner tbody').bgOutliner('getParent', $('#row2')), 1, 'Returned 1 for row 2');
        equal($('#outliner tbody').bgOutliner('getParent', $('#row1')), null, 'Returned null for row 1');
        equal($('#outliner tbody').bgOutliner('getParent', $('#row7')), 6, 'Returned 6 for row 7');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Add Node method tests
       */
      
      module('Add Node method');
      
      test('Invoking addNode on an element that is not a plugin instance should throw an error', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('addNode');
        }, 'Error was thrown');
      });
      
      test('Invoking addNode with an argument that is not a direct child of an instance should throw an error', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('addNode', $('#header-row'));
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Invoking addNode with an argument that is a direct child of an instance should return a reference to the instance', function() {
        // Create instance
        $('#outliner tbody').bgOutliner({'addAsChild': true});
        
        ok($('#outliner tbody').bgOutliner('addNode', $('#row1')).is('#outliner tbody'), 'Reference to self was returned');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('If addNode is called on row 1, a row with id "row9" should be added as the nineth row in the instance, with correct classes', function() {
        expect(4);
      
        // Create instance
        $('#outliner tbody').bgOutliner({'addAsChild': true});
      
        $('#outliner tbody').bgOutliner('addNode', $('#row1'));
        equal($('#outliner tbody').find('tr:eq(8)').attr('id'), $('#row9').attr('id'), 'The new node was inserted as last child of row 1');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row9')), 1, 'The new nodes level was set to 1');
        equal($('#outliner tbody').bgOutliner('getParent', $('#row9')), 1, 'The new nodes parent was set to row 1');
        ok($('#outliner tbody').bgOutliner('hasChildren', $('#row1')), 'Row 1 has a class that indicates it has child rows');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });

      test('If addNode is called without an argument, a root level node should be added', function() {
        expect(3);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        $('#outliner tbody').bgOutliner('addNode');
        equal($('#outliner tbody').find('tr:last').attr('id'), $('#row10').attr('id'), 'The new node was inserted at the bottom');
        equal($('#outliner tbody').bgOutliner('getLevel', $('#row10')), 0, 'The new nodes level was set to 0');
        equal($('#outliner tbody').bgOutliner('getParent', $('#row10')), null, 'The new nodes parent was set to null');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('If the prepend settings is true, nodes should be added as first children instead of last', function() {
        expect(2);
      
        // Create instance
        $('#outliner tbody').bgOutliner({'prepend' : true});
      
        $('#outliner tbody').bgOutliner('addNode');
        equal($('#outliner tbody').find('tr:first').attr('id'), $('#row11').attr('id'), 'The new root node was inserted at the top');
        $('#outliner tbody').bgOutliner('addNode', $('#row1'));
        equal($('#outliner tbody').find('tr.child-of-row1:first').attr('id'), $('#row12').attr('id'), 'The new node was inserted as first child of row 1');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('If addNode is called on a collapsed node, that node should be expanded', function() {
        expect(3);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        // Toggle node 1 (should show descendants)
        $('#outliner tbody').bgOutliner('toggleNode', $('#row1'));
        equal($('#outliner tbody').find('tr.child-of-row5:visible').length, 0, 'Node 5 is collapsed');
        
        // Add node to row 5
        $('#outliner tbody').bgOutliner('addNode', $('#row5'));
        equal($('#outliner tbody').find('tr.child-of-row5:visible').length, 2, 'Node 5 is expanded and child was added');
        equal($('#outliner tbody').find('#row5').hasClass('expanded'), true, 'Node 5 was given the expanded class');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });

      test('If addNode is called to add a child to another node, that parent node should get the hasChildren class', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        equal($('#row2').hasClass('has-children'), false, 'Before addNode: Row 2 does not have the hasChildren class');
        $('#outliner tbody').bgOutliner('addNode', $('#row2'));
        ok($('#row2').hasClass('has-children'), 'After addNode: Row 2 has the hasChildren class');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Remove Node method tests
       */

      module('Remove Node method');
      
      test('Invoking removeNode on an element that is not a plugin instance should throw an error', function() {
        raises(function() {
          $('#outliner tbody').bgOutliner('removeNode');
        }, 'Error was thrown');
      });
      
      test('Invoking removeNode with an argument that is not a direct child of an instance should throw an error', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
      
        raises(function() {
          $('#outliner tbody').bgOutliner('removeNode', $('#header-row'));
        }, 'Error was thrown');
        
        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Invoking removeNode with an argument that is a direct child of an instance should return a reference to the instance', function() {
        expect(2);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        ok($('#outliner tbody').bgOutliner('removeNode', $('#row9')).is('#outliner tbody'), 'Reference to self was returned');
        equal($('#outliner tbody').find('#row9').length, 0, 'Row 9 was removed');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Invoking removeNode with on a root level node should work', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        $('#outliner tbody').bgOutliner('removeNode', $('#row10'))
        equal($('#outliner tbody').find('#row10').length, 0, 'Root level node was removed');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Removing a node that has descendants should remove all of those descendants', function() {
        expect(6);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        $('#outliner tbody').bgOutliner('removeNode', $('#row3'));
        equal($('#outliner tbody').find('#row3').length, 0, 'Removing row 3 should remove node 3');
        equal($('#outliner tbody').find('#row4').length, 0, 'Removing row 3 should remove node 4');
        equal($('#outliner tbody').find('#row5').length, 0, 'Removing row 3 should remove node 5');
        equal($('#outliner tbody').find('#row13').length, 0, 'Removing row 3 should remove node 13');
        equal($('#outliner tbody').find('#row6').length, 0, 'Removing row 3 should remove node 6');
        equal($('#outliner tbody').find('#row7').length, 0, 'Removing row 3 should remove node 7');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('If a node that is an only child is removed, the hasChildren class should be removed from its parent', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        $('#outliner tbody').bgOutliner('addNode');
        $('#outliner tbody').bgOutliner('addNode', $('#row15'));
        $('#outliner tbody').bgOutliner('removeNode', $('#row16'));
        equal($('#row15').hasClass('has-children'), false, 'Row 15 does not have the hasChildren class');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Get Family method tests
       */

      module('Get Family method');
      
      test('Calling getFamily on row 1 should return rows 1, 12, 2, 14 and 8', function() {
        expect(5);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        var $descendants = $('#outliner tbody').bgOutliner('getFamily', $('#row1'));
        equal($descendants[0].attr('id'), 'row1', 'Row 1 was in the collection at the right place');
        equal($descendants[1].attr('id'), 'row12', 'Row 12 was in the collection at the right place');
        equal($descendants[2].attr('id'), 'row2', 'Row 2 was in the collection at the right place');
        equal($descendants[3].attr('id'), 'row14', 'Row 14 was in the collection at the right place');
        equal($descendants[4].attr('id'), 'row8', 'Row 8 was in the collection at the right place');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Calling getFamily on row 11 should return row 11', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        var $descendants = $('#outliner tbody').bgOutliner('getFamily', $('#row11'));
        equal($descendants[0].attr('id'), 'row11', 'Row 11 was in the collection at the right place');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Append Node method tests
       */

      module('Append Node method');
      
      test('Calling appendNode on row 2 to row 11 should move row 2 as a child to row 11', function() {
        expect(2);
      
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        $('#outliner tbody').bgOutliner('appendNode', $('#row11'), $('#row2'));
        equal( $('#outliner tbody').bgOutliner('getParent', $('#row2')), 11, 'Row 2 has row 11 as parent' );
        equal( $('#outliner tbody').find('#row2').next().attr('id'), 'row14', 'Row 2\'s child (row 14) was moved with row 2' );

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Get Drop Positions For Level method
       */
      
      module('Get Drop Positions For Level method');
      
      test('Calling getDropPositionsForLevel with "0" as argument should return the list [0,1,4,7]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getDropPositionsForLevel', 0), [0,1,4,7], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Calling getDropPositionsForLevel with "1" as argument should return the list [1,2,4,5,6,7]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getDropPositionsForLevel', 1), [1,2,4,5,6,7], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Calling getDropPositionsForLevel with "2" as argument should return the list [3,4,6,7]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getDropPositionsForLevel', 2), [3,4,6,7], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      /**
       * Get Invalid Drop Positions method
       */
      
      module('Get Invalid Drop Positions method');
      
      test('Calling getInvalidDropPositions on row 1 should return the list [5,6,7]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getInvalidDropPositions', $('#row1'), $('#outliner tbody').bgOutliner('getLevel', $('#row1'))), [5,6,7], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Calling getInvalidDropPositions on row 2 should return the list [3,4]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getInvalidDropPositions', $('#row2'), $('#outliner tbody').bgOutliner('getLevel', $('#row2'))), [3,4], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
      
      test('Calling getInvalidDropPositions on row 11 should return the list [2,3,4]', function() {
        // Create instance
        $('#outliner tbody').bgOutliner();
        
        deepEqual($('#outliner tbody').bgOutliner('getInvalidDropPositions', $('#row11'), $('#outliner tbody').bgOutliner('getLevel', $('#row11'))), [2,3,4], 'List matched expectations');

        // Destroy instance
        $('#outliner tbody').bgOutliner('destroy');
      });
    });
    // ]]>
  </script>
</body>
</html>